<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>QR Scanner liÃªn tá»¥c</title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
    }

    #video {
      width: 100%;
      max-width: 360px;
      height: auto;
      border: 4px solid #4CAF50;
      border-radius: 12px;
      margin-top: 20px;
    }

    textarea {
      margin-top: 20px;
      width: 90%;
      height: 200px;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <h2>ðŸ“· QuÃ©t QR liÃªn tá»¥c</h2>
  <video id="video" autoplay muted playsinline></video>
  <textarea id="resultArea" placeholder="Káº¿t quáº£ sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y..."></textarea>

  <!-- Ã‚m thanh -->
  <audio id="sound-success" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_b19cba9506.mp3" preload="auto"></audio>
  <audio id="sound-duplicate" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_736dbf50c8.mp3" preload="auto"></audio>

  <!-- QR Scanner script -->
  <script src="https://unpkg.com/qr-scanner@1.4.2/qr-scanner.umd.min.js"></script>
  <script>
    QrScanner.WORKER_PATH = 'https://unpkg.com/qr-scanner@1.4.2/qr-scanner-worker.min.js';

    const videoElem = document.getElementById('video');
    const resultArea = document.getElementById('resultArea');
    const scannedList = new Set();

    const soundSuccess = document.getElementById('sound-success');
    const soundDuplicate = document.getElementById('sound-duplicate');

    const scanner = new QrScanner(videoElem, result => {
      const text = typeof result === 'string' ? result : result.data || String(result);
      if (!scannedList.has(text)) {
        scannedList.add(text);
        resultArea.value += text + "\n";
        soundSuccess.play();
      } else {
        soundDuplicate.play();
      }
    }, {
      highlightScanRegion: true,
      maxScansPerSecond: 5
    });

    scanner.start();
  </script>
</body>
</html>
